module Securekey
  extend ActiveSupport::Concern

  def generate_secure_key
    special = %w{` ~ ! @ # $ % ^ & * ( ) = - [ ] { } \ | ; ' : " , . / < > ?}
    digits = (0..9).to_a
    chars = ('a'..'z').to_a
    cap_chars = ('A'..'Z').to_a

    result = chars.shuffle.take(4) + digits.shuffle.take(4) +
             special.shuffle.take(4) + cap_chars.shuffle.take(4)
    result.shuffle.join
  end
end
